) +
theme_bw()
ggpar(p, palette = "jco")
#formula <- y ~ poly(x, 3, raw = TRUE)
formula <- x ~ poly(y, 1, raw = TRUE)
#p <- ggplot(my.data, aes(`Goal 14 Score`, LnGDPpcpt)) +
p <- ggplot(my.data, aes(LnGDPpcpt, `Goal 14 Score`)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
#formula <- y ~ poly(x, 3, raw = TRUE)
formula <- y ~ poly(x, 1, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 14 Score`, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
#p <- ggplot(my.data, aes(`Goal 14 Score`, LnGDPpcpt)) +
p <- ggplot(my.data, aes(LnGDPpcpt, `Goal 14 Score`)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(my.data, aes(`Goal 14 Score`, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
library(tidyr)
df.lomg<-tidyr::gather(df, goalname, goalvalue, `Goal 1 Score`:`Goal 15 Score`, faktor_key=T)
df.lomg<-tidyr::gather(df, goalname, goalvalue, `Goal 1 Score`:`Goal 15 Score`, factor_key=T)
View(df.lomg)
df.long<-tidyr::gather(df, goalname, goalvalue, `Goal 1 Score`:`Goal 15 Score`, factor_key=T)
df.lomg<-NULL
df.long<-tidyr::gather(df, goalname, goalvalue, `Goal 1 Score`:`Goal 15 Score`, factor_key=T)
View(df.long)
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(~ goalname, rows= 5)
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(~ goalname, vars(goalname))
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(~ goalname))
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(~ goalname)+
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(nrow=5)+
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(ars(goalname), scales = "free")+
theme_bw()
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(vars(goalname), scales = "free")+
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(rows = goalnames)+
theme_bw()
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(rows = goalname)+
theme_bw()
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(rows = goalname) +
theme_bw()
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(rows = 5) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(rows = 5, cols=3) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt), group_by(goalname)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(rows = 5, cols= 3 ) +
theme_bw()
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt), group_by(goalname)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(rows = 5) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt), group_by(goalname)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
#facet_grid(rows = 5) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt, goalname))) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt, goalname)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
#facet_grid(rows = 5) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt, goalname)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
#facet_grid(rows = 5) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(vars(goanlname)) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(vars(goalname)) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(vars(goalname), cols=3) +
theme_bw()
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(vars(goalname), cols=vars(goalname)) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_grid(cols=vars(goalname)) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_wrap(vars(goalname), nrow = 5) +
theme_bw()
ggpar(p, palette = "jco")
formula <- y ~ poly(x, 3, raw = TRUE)
df.long<-tidyr::gather(df, goalname, goalvalue, `Goal 1 Score`:`Goal 15 Score`, factor_key=T)
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_wrap(vars(goalname), nrow = 5) +
theme_bw()
ggpar(p, palette = "jco")
ggsave('regression.pdf', dpi=320, width = 10, height = 10, units = 'cm')
ggsave('regression.pdf', dpi=320, width = 40, height = 40, units = 'cm')
p <- ggplot(my.data, aes(`Goal 1 Score`, LnGDPpcpt,Income)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
my.data<-df[,c('Country','LnGDPpcpt','Goal 1 Score','Income')]
formula <- y ~ poly(x, 3, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 1 Score`, LnGDPpcpt,Income)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(my.data, aes(`Goal 1 Score`, LnGDPpcpt, color=Income)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
#formula <- y ~ poly(x, 3, raw = TRUE)
formula <- y ~ poly(x, 1, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 1 Score`, LnGDPpcpt, color=Income)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
my.data<-df[,c('Country','LnGDPpcpt','Goal 10 Score','Income')]
#formula <- y ~ poly(x, 3, raw = TRUE)
formula <- y ~ poly(x, 1, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 10 Score`, LnGDPpcpt, color=Income)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
formula <- y ~ poly(x, 3, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 10 Score`, LnGDPpcpt, color=Income)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
ggsave('regressiong10.pdf', dpi=320, width = 40, height = 40, units = 'cm')
p <- ggplot(my.data, aes(`Goal 10 Score`, LnGDPpcpt, color=Income)) +
geom_point() +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
p <- ggplot(my.data, aes(`Goal 10 Score`, LnGDPpcpt, color=Income)) +
geom_point() +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
ggsave('regressiong10.pdf', dpi=320, width = 10, height = 10, units = 'cm')
ggsave('regressiong10.pdf', dpi=320, width = 20, height = 20, units = 'cm')
my.data<-df[,c('Country','LnGDPpcpt','Goal 14 Score','Income')]
formula <- y ~ poly(x, 3, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 14 Score`, LnGDPpcpt, color=Income)) +
geom_point() +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
ggsave('regressiong14.pdf', dpi=320, width = 20, height = 20, units = 'cm')
my.data<-df[,c('Country','LnGDPpcpt','Goal 15 Score','Income')]
formula <- y ~ poly(x, 3, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 15 Score`, LnGDPpcpt, color=Income)) +
geom_point() +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
ggsave('regressiong15.pdf', dpi=320, width = 20, height = 20, units = 'cm')
library(readxl)
library(ggplot2)
library(ggpubr)
library(stats)
library(psych)
library(tidyr)
wd<-getwd()
setwd(wd)
df<-as.data.frame(read_xlsx("Kopie von 2019GlobalIndexResults kg tmp.xlsx", sheet = "Correlations", range = "A1:R147"))
#lapply(df, class)
str(df)
# REPLACE 0 with NA!!
df[df==0]<-NA
df<-as.data.frame(read_xlsx("Kopie von 2019GlobalIndexResults kg tmp.xlsx", sheet = "Correlations", range = "A1:R147"))
#lapply(df, class)
str(df)
wd<-getwd()
setwd(wd)
df<-as.data.frame(read_xlsx("Kopie von 2019GlobalIndexResults kg tmp.xlsx", sheet = "Correlations", range = "A1:R147"))
#lapply(df, class)
str(df)
# REPLACE 0 with NA!!
df[df==0]<-NA
#####################################
x<-as.numeric(df$`Goal 10 Score`)
y<-as.numeric(df$LnGDPpcpt)
# polynom
lm( y ~ poly(x, 3, raw = TRUE))
coef(lm( y ~ poly(x, 3, raw = TRUE)))
summary(lm( y ~ poly(x, 3, raw = TRUE)))$r.squared
lm_coef<-coef(lm( y ~ poly(x, 3, raw = TRUE)))
mod <- lm( y ~ poly(x, 3, raw = TRUE))
plot(x, y)
lines(x[order(x)], predict(mod, list(x = x[order(x)])))
# exponent
mod <- nls(y ~ exp(a + b * x), start = list(a = 0, b = 0))
plot(x, y)
lines(x[order(x)], predict(mod, list(x = x[order(x)])))
my.data<-df[,c('Country','LnGDPpcpt','Goal 15 Score','Income')]
formula <- y ~ poly(x, 3, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 15 Score`, LnGDPpcpt, color=Income)) +
geom_point() +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
######################################################
report.df<-data.frame(goals=colnames(df[,3:17]), rsq=0)
for (i in 3:17) {
x<-df[,i]
report.df[(i-2),2]=summary(lm( y ~ poly(x, 3, raw = TRUE)))$r.squared
}
df.long<-tidyr::gather(df, goalname, goalvalue, `Goal 1 Score`:`Goal 15 Score`, factor_key=T)
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_wrap(vars(goalname), nrow = 5) +
theme_bw()
ggpar(p, palette = "jco")
wd<-getwd()
setwd(wd)
df<-as.data.frame(read_xlsx("Kopie von 2019GlobalIndexResults kg tmp.xlsx", sheet = "Correlations", range = "A1:R147"))
#lapply(df, class)
str(df)
# REPLACE 0 with NA!!
df[df==0]<-NA
#####################################
x<-as.numeric(df$`Goal 10 Score`)
y<-as.numeric(df$LnGDPpcpt)
# polynom
lm( y ~ poly(x, 3, raw = TRUE))
coef(lm( y ~ poly(x, 3, raw = TRUE)))
summary(lm( y ~ poly(x, 3, raw = TRUE)))$r.squared
lm_coef<-coef(lm( y ~ poly(x, 3, raw = TRUE)))
mod <- lm( y ~ poly(x, 3, raw = TRUE))
plot(x, y)
lines(x[order(x)], predict(mod, list(x = x[order(x)])))
# exponent
mod <- nls(y ~ exp(a + b * x), start = list(a = 0, b = 0))
plot(x, y)
lines(x[order(x)], predict(mod, list(x = x[order(x)])))
my.data<-df[,c('Country','LnGDPpcpt','Goal 15 Score','Income')]
formula <- y ~ poly(x, 3, raw = TRUE)
p <- ggplot(my.data, aes(`Goal 15 Score`, LnGDPpcpt, color=Income)) +
geom_point() +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
theme_bw()
ggpar(p, palette = "jco")
######################################################
report.df<-data.frame(goals=colnames(df[,3:17]), rsq=0)
for (i in 3:17) {
x<-df[,i]
report.df[(i-2),2]=summary(lm( y ~ poly(x, 3, raw = TRUE)))$r.squared
}
df.long<-tidyr::gather(df, goalname, goalvalue, `Goal 1 Score`:`Goal 15 Score`, factor_key=T)
p <- ggplot(df.long, aes(goalvalue, LnGDPpcpt)) +
geom_point(aes(color=Income)) +
stat_smooth(method = "lm", formula = formula) +
stat_regline_equation(
aes(label =  paste(..eq.label.., ..adj.rr.label.., sep = "~~~~")),
formula = formula
) +
facet_wrap(vars(goalname), nrow = 5) +
theme_bw()
ggpar(p, palette = "jco")
ggsave('regression_ppp.pdf', dpi=320, width = 40, height = 40, units = 'cm')
